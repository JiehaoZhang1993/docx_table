# 论文三线表--一键转换 工具操作手册 (新手版)

## 目录

1.  [简介](#1-简介)
2.  [准备工作：安装 Python](#2-准备工作安装-python)
    *   [Windows 用户](#windows-用户)
    *   [macOS 用户](#macos-用户)
    *   [Linux 用户](#linux-用户)
    *   [验证安装](#验证安装)
3.  [获取并安装工具](#3-获取并安装工具)
    *   [方法一：下载 ZIP 包 (推荐新手)](#方法一下载-zip-包-推荐新手)
    *   [方法二：使用 Git 克隆 (稍复杂)](#方法二使用-git-克隆-稍复杂)
    *   [安装依赖库](#安装依赖库)
4.  [运行工具](#4-运行工具)
5.  [使用图形界面 (GUI)](#5-使用图形界面-gui)
    *   [界面概览](#界面概览)
    *   [基本操作流程](#基本操作流程)
    *   [详细功能说明](#详细功能说明)
        *   [语言选择](#语言选择)
        *   [输入区域](#输入区域)
        *   [格式设置区域](#格式设置区域)
        *   [预览与导出区域](#预览与导出区域)
    *   [预览窗口](#预览窗口)
6.  [常见问题与解决](#6-常见问题与解决)
7.  [结语](#7-结语)

---

## 1. 简介

“论文三线表--一键转换”是一款方便快捷的小工具，旨在帮助您将常见的表格数据（如来自 Excel 或 CSV 文件，或直接粘贴的数据）轻松转换为符合学术论文要求的“三线表”格式，并直接输出为 Word (.docx) 文档。它提供了图形用户界面 (GUI)，操作直观简单，无需编写任何代码。

本手册将指导您完成从安装 Python 环境到成功使用本工具的全过程。

---

## 2. 准备工作：安装 Python

本工具是用 Python 语言编写的，因此您需要在计算机上安装 Python 环境。

### Windows 用户

1.  **访问官网**：打开您的网络浏览器，访问 Python 官方网站：[https://www.python.org/](https://www.python.org/)
2.  **下载安装包**：将鼠标悬停在导航栏的 "Downloads" 上，通常会自动推荐适合您 Windows 系统的最新稳定版本。点击下载安装程序（通常是 `.exe` 文件）。
3.  **运行安装程序**：下载完成后，双击运行 `.exe` 文件。
4.  **重要！勾选 "Add Python to PATH"**：在安装程序的第一个界面，**务必**勾选底部的 "Add Python X.X to PATH" (X.X 代表版本号) 这个选项！这会让您的计算机能够更容易地找到并运行 Python。
5.  **选择 "Install Now"**：点击 "Install Now" 使用默认设置进行安装。等待安装完成。

### macOS 用户

macOS 通常自带一个较旧版本的 Python。建议安装较新版本：

1.  **访问官网**：[https://www.python.org/](https://www.python.org/)
2.  **下载安装包**：在 "Downloads" -> "macOS" 下找到最新的 macOS 安装包（通常是 `.pkg` 文件）并下载。
3.  **运行安装程序**：双击下载的 `.pkg` 文件，按照安装向导的提示完成安装。通常一路点击 "Continue", "Agree", "Install" 即可。安装过程中可能需要输入您的用户密码。

### Linux 用户

大多数 Linux 发行版自带 Python 3。您可以通过包管理器安装或更新：

*   **Debian/Ubuntu**:
    ```bash
    sudo apt update
    sudo apt install python3 python3-pip python3-venv
    ```
*   **Fedora**:
    ```bash
    sudo dnf update
    sudo dnf install python3 python3-pip
    ```

### 验证安装

安装完成后，我们需要验证一下 Python 是否安装成功，并且 `pip`（Python 的包管理器）是否可用。

1.  **打开终端或命令提示符**：
    *   **Windows**: 按下 `Win` 键，输入 `cmd` 或 `powershell`，然后按 Enter。
    *   **macOS**: 打开 "应用程序" -> "实用工具" -> "终端"。
    *   **Linux**: 通常可以在应用程序菜单中找到 "终端" 或使用快捷键 (如 `Ctrl+Alt+T`)。
2.  **输入命令**：在打开的窗口中，分别输入以下命令，每输入一行后按 Enter：
    ```bash
    python --version
    ```
    或者在某些系统上可能是：
    ```bash
    python3 --version
    ```
    接着输入：
    ```bash
    pip --version
    ```
    或者在某些系统上可能是：
    ```bash
    pip3 --version
    ```
3.  **检查输出**：如果看到类似 `Python 3.x.x` 和 `pip x.x.x from ...` 的输出（x.x 是版本号），说明 Python 和 pip 都已成功安装并配置好。如果提示 "命令未找到" 或类似错误，请检查 Python 安装步骤，特别是 Windows 用户是否勾选了 "Add Python to PATH"。

---

## 3. 获取并安装工具

现在您的计算机有了 Python 环境，接下来需要获取本工具的源代码并安装它所依赖的其他软件包。

### 方法一：下载 ZIP 包 (推荐新手)

1.  **访问项目页面**：打开浏览器，访问工具的 GitHub 页面：[https://github.com/JiehaoZhang1993/docx_table_converter](https://github.com/JiehaoZhang1993/docx_table_converter) (请确认这是正确的项目地址)
2.  **下载代码**：在页面右上角找到绿色的 "<> Code" 按钮，点击它，然后选择 "Download ZIP"。
3.  **解压文件**：浏览器会将项目代码下载为一个 `.zip` 压缩包。找到这个文件（通常在“下载”文件夹里），右键点击它，选择“全部解压缩...”或类似选项，将文件解压到一个您方便查找的位置（例如桌面或文档文件夹）。解压后会得到一个名为 `docx_table_converter-main` (或类似名称) 的文件夹。

### 方法二：使用 Git 克隆 (稍复杂)

如果您熟悉 Git 或者想尝试更标准的开发方式，可以使用 Git。

1.  **安装 Git** (如果尚未安装)：访问 [https://git-scm.com/downloads](https://git-scm.com/downloads) 下载并安装 Git。
2.  **打开终端或命令提示符**。
3.  **导航到目标文件夹**：使用 `cd` 命令切换到您想存放项目代码的文件夹。例如：
    ```bash
    cd Desktop
    ```
4.  **克隆项目**：执行以下命令：
    ```bash
    git clone https://github.com/JiehaoZhang1993/docx_table_converter.git
    ```
    这会在当前目录下创建一个名为 `docx_table_converter` 的文件夹，并下载所有代码。

### 安装依赖库

无论您使用哪种方法获取了代码，都需要进入项目文件夹并安装所需的依赖库。

1.  **打开终端或命令提示符**。
2.  **进入项目文件夹**：使用 `cd` 命令进入您刚刚解压或克隆得到的项目文件夹。例如：
    *   如果解压到桌面，可能是：`cd Desktop/docx_table_converter-main`
    *   如果克隆到桌面，则是：`cd Desktop/docx_table_converter`
3.  **安装依赖**：在项目文件夹内执行以下命令：
    ```bash
    pip install pandas python-docx PyQt5
    ```
    *   `pandas` 用于处理表格数据。
    *   `python-docx` 用于创建和操作 Word 文档。
    *   `PyQt5` 是构建图形用户界面的库。

    *(**开发者注意**: 为了方便他人使用，建议在项目根目录创建一个 `requirements.txt` 文件，内容如下，然后用户只需运行 `pip install -r requirements.txt` 即可)*
    ```
    pandas>=1.0.0
    python-docx>=0.8.11
    PyQt5>=5.14.0
    ```
4.  **等待安装完成**：终端会显示下载和安装这些库的过程。请确保没有出现明显的错误信息。

---

## 4. 运行工具

安装完所有依赖后，就可以运行工具了。

1.  **确保在项目文件夹内**：打开终端或命令提示符，使用 `cd` 命令确保您当前位于项目的主文件夹（即包含 `run_gui.py` 文件的那个文件夹）。
2.  **运行命令**：执行以下命令：
    ```bash
    python run_gui.py
    ```
3.  **等待窗口出现**：稍等片刻，您应该能看到标题为“论文三线表--一键转换”的应用程序窗口弹出。

---

## 5. 使用图形界面 (GUI)

工具的主窗口提供了所有操作功能。

### 界面概览

窗口大致分为几个区域：

*   **顶部**：语言选择。
*   **输入区域**：用于选择输入文件或粘贴数据，并设置相关选项（工作表、表头行数、索引列）。
*   **格式设置区域**：设置输出表格的字体、字号、标题、描述、是否包含索引以及输出模式。
*   **底部按钮区域**：用于预览和导出结果。

### 基本操作流程

1.  **选择语言**：根据需要选择“中文”或“English”。
2.  **提供数据**：
    *   **方式一：加载文件**
        *   点击“浏览”按钮，选择您的 `.csv`, `.xls`, 或 `.xlsx` 文件。
        *   如果是 Excel 文件，在“工作表”下拉框中选择正确的工作表。
        *   在“表头行数”中选择您的数据实际包含几行表头（0、1 或 2）。
        *   在“索引列”下拉框中选择哪一列应作为行的标识（如果不需要索引，选“无”）。
    *   **方式二：粘贴数据**
        *   点击“粘贴表格数据”按钮。
        *   在弹出的“粘贴表格数据”窗口中，先从 Excel 或其他地方复制您的表格数据。
        *   回到弹出窗口，点击“粘贴”按钮，数据会显示在表格中。
        *   在此窗口中选择正确的“表头行数”。
        *   点击“确定”按钮。
        *   回到主窗口，在“索引列”下拉框中选择索引列（或“无”）。
3.  **设置格式**：
    *   选择期望的“字体”和“字号”。
    *   输入表格的“标题”和“描述”（可选）。
    *   勾选/取消勾选“包含索引”来决定是否在输出的 Word 表格中保留索引列。
    *   选择“模式”：“append”（追加到现有 Word 文档末尾）或“overwrite”（覆盖现有 Word 文档或创建新文档）。
4.  **预览 (可选但推荐)**：
    *   点击“预览”按钮。
    *   在弹出的预览窗口中，左侧是原始数据（经过索引处理后），右侧是生成的 Word 文档的预览信息。
    *   您可以点击“打开预览文档”直接用 Word 打开临时生成的预览文件查看效果。
    *   如果效果满意，可以点击“保存文档”直接将预览的这个文件另存到指定位置。
    *   点击“关闭”返回主窗口。
5.  **导出**：
    *   点击“导出”按钮。
    *   在弹出的对话框中，选择您想要保存 Word 文档的位置和文件名，然后点击“保存”。
    *   如果导出成功，会弹出成功提示。

### 详细功能说明

#### 语言选择

*   **Language / 语言**: 下拉框切换界面语言（中文/English）。

#### 输入区域

*   **输入文件**: 显示当前选择的文件路径（只读）。
*   **浏览**: 点击打开文件选择对话框，支持 `.csv`, `.xls`, `.xlsx` 文件。
*   **导入成功**: 文件成功加载后会在此处显示“导入成功”几秒钟。
*   **工作表**: (仅当加载 Excel 文件时显示) 下拉框选择要处理的工作表。
*   **表头行数**: 数字选择框，设置您的数据源实际有几行作为表头 (0, 1, 或 2)。
    *   `0`: 数据没有表头行，程序会自动生成如 "列 1", "列 2" 的表头。
    *   `1`: 数据的第一行是表头。
    *   `2`: 数据的前两行是合并的复合表头。
*   **索引列**: 下拉框选择数据中的哪一列作为表格的索引（行标识）。
    *   `无`: 不使用数据中的任何列作为索引，Word 表格将没有单独的索引列（除非您勾选了下方的“包含索引”，此时会使用默认的数字索引）。
    *   选择具体列名: 将该列作为索引。
*   **粘贴表格数据**: 点击弹出粘贴对话框。
    *   **粘贴对话框**:
        *   先从外部复制数据。
        *   点击“粘贴”按钮将数据填入。
        *   设置此数据的“表头行数”。
        *   点击“确定”将处理后的数据传回主窗口。
        *   **注意**: 索引列的选择是在**主窗口**完成的。
*   **数据源冲突**: 如果您先加载了文件，又粘贴了数据，程序会弹出一个“数据源选择”对话框，让您确认使用哪个数据。

#### 格式设置区域

*   **字体**: 下拉框选择 Word 表格中使用的字体。
*   **字号**: 数字选择框设置 Word 表格中使用的字号。
*   **标题**: 输入您想在 Word 文档中显示的表格主标题。
*   **描述**: 输入您想在 Word 文档中显示的表格描述文字（通常在标题下方）。
*   **包含索引**: 复选框。
    *   **勾选**: 最终输出的 Word 表格会包含索引列。
        *   如果您在“索引列”下拉框中选择了具体列，则该列成为 Word 表格的索引。
        *   如果您在“索引列”下拉框中选了“无”，则 Word 表格会使用默认的数字行号作为索引。
    *   **不勾选**: 最终输出的 Word 表格**不**包含索引列。
        *   如果您在“索引列”下拉框中选择了具体列，该列将**不会**出现在最终的 Word 表格中（既不作为索引，也不作为数据列）。
        *   如果您在“索引列”下拉框中选了“无”，则按原始数据（无索引）输出。
*   **模式**: 下拉框选择导出模式。
    *   `append`: 如果指定的输出文件已存在，则将新表格追加到文件末尾。如果文件不存在，则创建新文件。
    *   `overwrite`: 如果指定的输出文件已存在，则完全覆盖它。如果文件不存在，则创建新文件。

#### 预览与导出区域

*   **预览**: 点击生成临时 Word 文件并在预览窗口显示效果。
*   **导出**: 点击将当前设置下的表格直接保存为 Word 文件。

### 预览窗口

点击主窗口的“预览”按钮后弹出。

*   **左侧 (原始数据)**: 显示经过表头和索引处理后的表格数据。
*   **右侧 (预览效果)**:
    *   显示生成的临时 Word 文件路径和您设置的格式信息（标题、字体等）。
    *   **打开预览文档**: 点击直接调用系统默认程序（如 Microsoft Word）打开这个临时生成的 `.docx` 文件，让您查看最真实的排版效果。
    *   **保存文档**: 点击可以将这个预览时生成的临时 Word 文件另存为您指定的文件名和位置。
    *   **关闭**: 点击关闭预览窗口，返回主窗口。

---

## 6. 常见问题与解决

*   **运行 `python run_gui.py` 时提示 `ModuleNotFoundError: No module named 'docx_table_converter'`**:
    *   **原因**: Python 找不到工具的代码。
    *   **解决**: 请确保您在终端中**当前所在的目录**是项目的根目录（即包含 `run_gui.py` 和 `src` 文件夹的那个目录）。使用 `cd` 命令切换过去。
*   **运行 `python run_gui.py` 时提示 `ModuleNotFoundError: No module named 'pandas'` (或其他库名)**:
    *   **原因**: 依赖库没有安装成功。
    *   **解决**: 回到 [安装依赖库](#安装依赖库) 步骤，在项目文件夹内重新运行 `pip install pandas python-docx PyQt5` 命令。确保网络连接正常，且没有报错。
*   **加载文件时出错，提示 `list index out of range`**:
    *   **原因**: 很可能是您选择的“表头行数”与实际文件内容不符，或者选择的工作表是空的。
    *   **解决**: 确认 Excel 文件中选择的工作表有数据，并尝试调整主窗口的“表头行数”选项 (0, 1, 或 2)，使其与您的数据结构匹配。
*   **导出或保存文件时提示权限错误**:
    *   **原因**: 程序可能没有权限写入您选择的文件夹（例如系统保护目录）。
    *   **解决**: 尝试将文件导出或保存到其他位置，如“文档”文件夹或桌面。
*   **界面显示乱码 (可能性较低)**:
    *   **原因**: 系统字体或编码问题。
    *   **解决**: 确保您的操作系统语言设置正确。

---

## 7. 结语

希望这份手册能帮助您顺利使用“论文三线表--一键转换”工具。如果您在使用过程中遇到任何本手册未涵盖的问题，或者有任何建议，欢迎通过项目 GitHub 页面的 "Issues" 功能进行反馈。

**项目地址**: [https://github.com/JiehaoZhang1993/docx_table_converter](https://github.com/JiehaoZhang1993/docx_table_converter)

祝您使用愉快！